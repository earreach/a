<!doctype html>
<html>
<head>
<meta charset="{DT_CHARSET}"/>
<title>{if $seo_title}{$seo_title}{else}{if $head_title}{$head_title}{$DT[seo_delimiter]}{/if}{$DT[sitename]}{/if}</title>
<meta http-equiv="x-ua-compatible" content="IE=8"/>
<link rel="stylesheet" type="text/css" href="{DT_SKIN}style.css?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"/>
<link rel="stylesheet" type="text/css" href="{DT_SKIN}know.css?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"/>
<link rel="stylesheet" type="text/css" href="{DT_PATH}file/style/home.reset.css?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"/>
<script type="text/javascript" src="{DT_PATH}lang/{DT_LANG}/lang.js?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"></script>
<script type="text/javascript" src="{DT_PATH}file/script/config.js?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"></script>
{if strpos($DT_MBS, 'IE') === false}
<script type="text/javascript" src="{DT_STATIC}script/jquery-3.6.4.min.js?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"></script>
{else}
<script type="text/javascript" src="{DT_STATIC}script/jquery-1.12.4.min.js?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"></script>
{/if}
<script type="text/javascript" src="{DT_STATIC}script/common.js?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"></script>
<script type="text/javascript" src="{DT_STATIC}script/page.js?v={if DT_DEBUG}{DT_TIME}{else}{DT_REFRESH}{/if}"></script>
<script type="text/javascript">if(parent.location == window.location) Go('{$linkurl}');</script>
</head>
<body>
<iframe id="proxy_iframe" src="" style="display:none"></iframe>
<iframe src="" name="send" id="send" style="display:none;"></iframe>
<div id="destoon_answer">
{if $action == 'vote_show'}
	<div class="m">
		<div class="answer_box">
			<div class="answer_head">投票结果</div>
			<table cellpadding="8" cellspacing="1" style="width:1000px;margin:20px auto;" bgcolor="#DDDDDD">
			<tr bgcolor="#F1F1F1" align="center">
			<td>回答者</td>
			<td>票数</td>
			<td width="200">&nbsp;</td>
			<td>比例</td>
			</tr>
			{loop $votes $v}
			<tr bgcolor="#FFFFFF" align="center">
			<td>
			{if $v[hidden]}
			匿名
			{else}
				{if $v[username]}
				<a href="{$MOD[linkurl]}{rewrite('search.php?username='.$v['username'])}" class="b" target="_blank">{$v[passport]}</a>
				{else}
				<span title="{hide_info($v[ip], 'ip')}">游客</span>
				{/if}
			{/if}
			</td>
			<td>{$v[vote]}</td>
			<td align="left"><div class="vote_b"><div class="vote_s" style="width:{$v[precent]};"> </div></div></td>
			<td>{$v[precent]}</td>
			</tr>
			{/loop}
			</table>
			<center><input type="button" value="返 回" onclick="Go('?itemid={$itemid}');" class="btn-green"/></center>
			<br/>
		</div>
	</div>
{else}
	{if $could_admin && $item[process]==1}
	<div class="m">
		<div class="answer_box">
			<div class="answer_head">处理提问</div>
			<div class="question_op">
				<div><span class="px14">如果已获得满意的回答，请及时采纳，感谢回答者。若还没有满意的回答，可以尝试以下操作： </span></div>	
				{if $items>1}
				<div><a href="?itemid={$itemid}&action=vote" onclick="return confirm('确定要举行投票吗？');" class="b" target="_top">举行投票</a><span class="f_gray"> - 不知道哪个回答最好，让网友投票来选出最佳答案;</span></div>
				{/if}
				<div><span onclick="Ds('add_content');H();" class="c_p f_dblue">补充问题</span><span class="f_gray"> - 补充提问细节，以得到更准确的答案;</span></div>
				<div id="add_content" style="display:none;background:#F1F1F1;padding:16px;">
				<form method="post" action="?" target="_top">
				<input type="hidden" name="itemid" value="{$itemid}"/>
				<input type="hidden" name="action" value="addition"/>
				<textarea name="content" id="content" style="width:90%;height:80px;margin:0 0 10px 0;">{$item[addition]}</textarea><br/>
				<input type="submit" value=" 确 认 " class="btn-blue"/>&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" value=" 取 消 " class="btn" onclick="Dh('add_content');H();"/>
				</form>
				</div>
				{if $item[raise] < $MOD[maxraise]}
				<div><span onclick="Ds('add_credit');H();" class="c_p f_dblue">提高悬赏</span><span class="f_gray"> - 提高悬赏，以提高问题的关注度;</span></div>
				<div id="add_credit" style="display:none;background:#F1F1F1;padding:16px;font-size:14px;">
					<form method="post" action="?" target="_top">
					<input type="hidden" name="itemid" value="{$itemid}"/>
					<input type="hidden" name="action" value="raise"/>
					提问期内，可以追加悬赏 <b class="f_red">{$MOD[maxraise]}</b> 次(已追加<b>{$item[raise]}</b>次)。悬赏一次，可延长问题的有效期 <b class="f_blue">{$MOD[raisedays]}</b> 天。<br/> 
					当您一次悬赏的{$DT[credit_name]}高于 <b>20</b> 分时，该问题将等同于新提出的问题，在所属分类的问题列表中显示为最新。 <br/>
					追加悬赏
					<select name="credit">
					{loop $CREDITS $v}
					{if $v>0}<option value="{$v}">{$v}</option>{/if}
					{/loop}
					</select>
					分  当前{$DT[credit_name]} <b class="f_blue">{$_credit}</b><br/>
					<div style="padding:6px 0;">
					<input type="submit" value=" 确 认 " class="btn-blue"/>&nbsp;&nbsp;&nbsp;&nbsp;
					<input type="button" value=" 取 消 " class="btn" onclick="Dh('add_credit');H();"/>
					</form>
					</div>
				</div>
				{/if}
				<div><a href="?itemid={$itemid}&action=close" onclick="return confirm('确定要关闭这个问题吗？');" class="b" target="_top">关闭问题</a><span class="f_gray"> - 没有满意的回答 ，可以直接结束提问，关闭问题;</span></div>
			</div>
		</div>
	</div>
	{/if}
	{if $answers}
	<div id="destoon_answers">
	{loop $answers $k $v}
	{if $k==count($answers)-1}<a name="last"></a>{/if}
	<div class="b10"></div>
	<div class="m">
		<div class="know_show">
			<table>
			<tr>
			<td valign="top" class="know_show_l">
			<ul>
			{if $v[hidden]}
			<li><img src="{useravatar('', 'large')}" alt="" class="know_avatar"/></li>
			<li id="u_{$v[itemid]}"><b class="f_gray">匿名</b></li>
			{else}
			<li><img src="{useravatar($v[username], 'large')}" alt="" class="know_avatar"/></li>
			<li id="u_{$v[itemid]}">
				{if $v[username]}
				<a href="{$MOD[linkurl]}{if $v[expert]}{rewrite('expert.php?username='.$v['username'])}{else}{rewrite('search.php?username='.$v['username'])}{/if}" target="_blank" class="b"><b>{$v[passport]}</b></a>
				{else}
				<b title="{hide_info($item[ip], 'ip')}" class="f_gray">游客</b>
				{/if}
			</li>
			{/if}
			{if $v[expert]}<li><span class="fb_green">专家</span></li>{/if}
			<li></li>
			</ul>
			</td>
			<td valign="top">
				<div class="know_info">
					<span class="f_r g_gray">
					{if $could_admin && $item[process] == 1}
					<span onclick="choose_answer({$v[itemid]});" class="c_p f_dblue"/>采纳为答案</span> &nbsp;
					{/if}
					{if $item[process] == 2}
						{if $could_admin}
						<span onclick="if(confirm('确定要移除此投票选项吗？')) Dd('send').src='?itemid={$itemid}&aid={$v[itemid]}&action=vote_del';" class="c_p f_dblue"/>移除选项</span> &nbsp;
						{/if}
						{if !$could_vote || $could_admin}
						<span onclick="Go('?itemid={$itemid}&action=vote_show');" class="c_p f_dblue"/>投票结果</span> &nbsp;
						{/if}
						{if $could_vote}
						<span onclick="Dd('send').src='?itemid={$itemid}&aid={$v[itemid]}&action=vote_add';" class="c_p f_dblue"/>投一票</span> &nbsp;
						{/if}
					{/if}
					</span>
					<i class="ui-ico-time">{timetodate($v[addtime], 5)}</i>
					{if $MOD[ip]}<i class="ui-ico-area">IP属地 {ip2area($v[ip], $MOD[ip])}</i>{/if}
				</div>
				<div class="content" id="a_{$v[itemid]}">{$v[content]}</div>
			</td>
			</tr>
			</table>
		</div>
	</div>
	{/loop}
	{if $pages}<div class="pages">{$pages}</div>{/if}
	</div>
	{/if}
	{if $could_admin && $item[process]==1}
	<div class="m">
		<div id="choose_form" style="display:none;">
			<div class="answer_box">
				<div class="answer_head">采纳答案</div>
				<div class="answer_body" id="choose_a"></div>
				<div class="answer_foot" id="choose_u"></div>
				<form method="post" action="?" target="_top" onsubmit="return choose_check();">
				<input type="hidden" name="aid" id="aid" value="0"/>
				<input type="hidden" name="action" value="choose"/>
				<input type="hidden" name="itemid" value="{$itemid}"/>
				<table width="100%" cellpadding="8" cellspacing="0">
				<tr>
				<td align="right" valign="top" class="px14"><br/>感谢语或评论：</td>
				<td><textarea rows="6" cols="70" name="thx" id="thx_content" class="f_gray" onfocus="if(this.value=='说声谢谢，感谢回答者的无私帮助'){this.value='';this.className='';}">说声谢谢，感谢回答者的无私帮助</textarea>
				</td>
				</tr>
				<tr>
				<td align="right"  class="px14">额外奖励：</td>
				<td>	
				<select name="credit" id="choose_credit">
				<option value="0">0</option>
				{loop $CREDITS $v}
				{if $v>0}<option value="{$v}">{$v}</option>{/if}
				{/loop}
				</select>
				<span class="f_gray">如果您对这一回答非常满意,您可以选择给回答者额外的奖励</span>
				</td>
				</tr>
				<tr>
				<td width="180"> </td>
				<td>
				<input type="submit" value=" 确 认 " class="btn-blue"/>&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" value=" 取 消 " class="btn" onclick="choose_cancel();"/>
				</td>
				</tr>
				</table>
				</form>
			</div>
		</div>
	</div>
	{/if}	
	{if $could_answer}
	<div class="m">
		<div class="answer_box">
			<div class="answer_head">我来回答</div>
		</div>
		<div class="know_show">
		<table>
		<tr>
		<td class="know_show_l">
		<script type="text/javascript">
		var destoon_uname = get_cookie('username');
		document.write('<ul>');
		document.write('<li><img src="'+DTPath+'api/avatar/show.php?size=large&reload={DT_TIME}&username='+destoon_uname+'" class="know_avatar"/></li>');
		document.write('<li>'+(destoon_uname ? '<b>'+destoon_uname+'</b>' : '<a href="{$MODULE[2][linkurl]}{$DT[file_login]}" target="_top">登录</a> / <a href="{$MODULE[2][linkurl]}{$DT[file_register]}" target="_top">注册</a>')+'</li>');
		document.write('<li></li></ul>');
		</script>
		</td>
		<td><textarea style="width:996px;height:96px;margin:16px 0 12px 16px;color:#999999;font-size:14px;border:#EEEEEE 1px solid;" onfocus="parent.Dwidget('{$MODULE[2][linkurl]}{$DT[file_my]}?mid={$moduleid}&job=answer&action=add&itemid={$itemid}', '回答：{$item[title]}', 1220);">回答：{$item[title]}</textarea></td>
		</tr>			
		</table>
	</div>
	</div>
	{/if}
{/if}
</div>
<script type="text/javascript">
function choose_check() {
	return true;
}
function choose_answer(id) {
	Dd('choose_a').innerHTML = Dd('a_'+id).innerHTML;
	Dd('choose_u').innerHTML = Dd('u_'+id).innerHTML;
	Dd('aid').value = id;
	Ds('choose_form');
	H();
	Dd('choose_credit').focus();
}
function choose_cancel() {
	Dd('choose_a').innerHTML = '';
	Dd('choose_u').innerHTML = '';
	Dd('aid').value = 0;
	Dh('choose_form');
	H();
}
function H() {
	Dd('proxy_iframe').src = '{$MOD[linkurl]}ajax.php?action=proxy&itemid=2#'+Dd('destoon_answer').scrollHeight+'|{if $could_answer}1{else}0{/if}';
}
function ImgZoom(i, m) {
	var m = m ? m : 550; var w = i.width;
	if(w < m) return;
	var h = i.height;
	i.title = L['click_open'];
	i.height = parseInt(h*m/w);
	i.width = m;
	i.onclick = function (e) {window.open(DTPath+'api/view.php?img='+i.src);}
}
function Z() {
	try {
	var content_id = 'destoon_answers';
	var img_max_width = {$MOD[max_width]};
	var Imgs = Dd(content_id).getElementsByTagName("img");
	for(var i=0;i<Imgs.length;i++) {ImgZoom(Imgs[i], img_max_width);}
	var Links = Dd(content_id).getElementsByTagName("a");
	for(var i=0;i<Links.length;i++)	{if(Links[i].target != '_blank') {if(document.domain && Links[i].href.indexOf(document.domain) == -1 && Links[i].href.indexOf('javascript:') == -1) Links[i].target = '_blank';}}
	} catch(e) {}
}
$(function(){
	Z();
	H();
});
</script>
</body>
</html>