{template 'header', 'member'}
{if $CK}<div class="warn">当前设置<span class="f_red">正在审核中</span>，暂时不可修改</div>{/if}
<div class="menu">
<table cellpadding="0" cellspacing="0">
<tr>
<td class="tab" id="Tab0"><a href="javascript:Tab(0);"><span>常用设置</span></a></td>
<td class="tab" id="Tab1"><a href="javascript:Tab(1);"><span>导航菜单</span></a></td>
<td class="tab" id="Tab2"><a href="javascript:Tab(2);"><span>侧栏设置</span></a></td>
<td class="tab" id="Tab3"><a href="javascript:Tab(3);"><span>首页设置</span></a></td>
<td class="tab" id="Tab4"><a href="javascript:Tab(4);"><span>其他设置</span></a></td>
</tr>
</table>
</div>
{load('webuploader.min.js')}
{load('url2video.js')}
{load('player.js')}
<form method="post" action="?" id="dform" onsubmit="return Dcheck();">
<input type="hidden" name="tab" id="tab" value="{$tab}"/>
<div id="Tabs0" style="display:;">
<table cellpadding="10" cellspacing="1" class="tb">
<tr>
<td class="tl">自定义背景图</td>
<td class="tr"><input name="setting[background]" type="text" size="70" id="background" value="{$background}" readonly ondblclick="Dthumb({$moduleid},0,0, Dd('background').value, true, 'background');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="Dthumb({$moduleid},0,0, Dd('background').value, true, 'background');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('background').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('background').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">自定义背景色</td>
<td class="tr f_gray">{dstyle('setting[bgcolor]', $bgcolor)}</td>
</tr>
<tr>
<td class="tl">自定义LOGO</td>
<td class="tr"><input name="setting[logo]" type="text" size="70" id="logo" value="{$logo}" readonly ondblclick="Dthumb({$moduleid},0,0, Dd('logo').value, true, 'logo');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="Dthumb({$moduleid},0,0, Dd('logo').value, true, 'logo');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('logo').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('logo').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">自定义CSS</td>
<td class="tr"><textarea name="setting[css]" id="css" style="width:433px;height:60px;overflow:visible;">{$css}</textarea></td>
</tr>
<tr>
<td class="tl">横幅宽度</td>
<td class="tr">
<input type="text" size="5" name="setting[bannerw]" value="{$bannerw}" id="bannerw"/> px
&nbsp;&nbsp;&nbsp;&nbsp;高度
<input type="text" size="5" name="setting[bannerh]" value="{$bannerh}" id="bannerh"/> px
</td>
</tr>
<tr>
<td class="tl">横幅显示方式</td>
<td class="tr">
<label><input type="radio" name="setting[bannert]" id="bannert_0" value="0"{if $bannert==0} checked{/if} onclick="Ds('bt_0');Dh('bt_1');Dh('bt_2');"/> 图片</label>&nbsp;&nbsp;
<label><input type="radio" name="setting[bannert]" id="bannert_1" value="1"{if $bannert==1} checked{/if} onclick="Dh('bt_0');Ds('bt_1');Dh('bt_2');"/> 视频</label>&nbsp;&nbsp;
<label><input type="radio" name="setting[bannert]" id="bannert_2" value="2"{if $bannert==2} checked{/if} onclick="Dh('bt_0');Dh('bt_1');Ds('bt_2');"/> 幻灯片</label>&nbsp;&nbsp;
</td>
</tr>
<tr id="bt_0" style="display:{if $bannert!=0}none{/if};">
<td class="tl">横幅图片地址</td>
<td class="tr"><input name="setting[banner]" type="text" size="70" id="banner" value="{$banner}" readonly ondblclick="Dthumb({$moduleid},0,0, Dd('banner').value, true, 'banner');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="Dthumb({$moduleid},0,0, Dd('banner').value, true, 'banner');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('banner').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('banner').value='';"/>
</span>
</td>
</tr>
<tr id="bt_1" style="display:{if $bannert!=1}none{/if};">
<td class="tl">横幅视频地址</td>
<td class="tr"><input name="setting[bannerf]" type="text" size="70" id="bannerf" value="{$bannerf}" readonly/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="Dfile({$moduleid}, Dd('bannerf').value, 'bannerf', 'mp4');"/>
<img src="{DT_STATIC}image/ico-play.png" title="预览" onclick="_preview(Dd('bannerf').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('bannerf').value='';"/>
</span>
<span id="dbannerf" class="f_red"></span></td>
</tr>
<tbody id="bt_2" style="display:{if $bannert!=2}none{/if};">
<tr>
<td class="tl">横幅图片地址1</td>
<td class="tr"><input name="setting[banner1]" type="text" size="70" id="banner1" value="{$banner1}" readonly ondblclick="Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner1').value, true, 'banner1');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner1').value, true, 'banner1');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('banner1').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('banner1').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">横幅图片链接1</td>
<td class="tr"><input name="setting[bannerlink1]" type="text" size="70" id="bannerlink1" value="{$bannerlink1}"/></td>
</tr>
<tr>
<td class="tl">横幅图片地址2</td>
<td class="tr"><input name="setting[banner2]" type="text" size="70" id="banner2" value="{$banner2}" readonly ondblclick="if(Dd('banner1').value==''){alert('请先上传横幅图片地址1');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner2').value, true, 'banner2');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="if(Dd('banner1').value==''){alert('请先上传横幅图片地址1');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner2').value, true, 'banner2');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('banner2').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('banner2').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">横幅图片链接2</td>
<td class="tr"><input name="setting[bannerlink2]" type="text" size="70" id="bannerlink2" value="{$bannerlink2}"/></td>
</tr>
<tr>
<td class="tl">横幅图片地址3</td>
<td class="tr"><input name="setting[banner3]" type="text" size="70" id="banner3" value="{$banner3}" readonly ondblclick="if(Dd('banner2').value==''){alert('请先上传横幅图片地址2');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner3').value, true, 'banner3');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="if(Dd('banner2').value==''){alert('请先上传横幅图片地址2');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner3').value, true, 'banner3');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('banner3').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('banner3').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">横幅图片链接3</td>
<td class="tr"><input name="setting[bannerlink3]" type="text" size="70" id="bannerlink3" value="{$bannerlink3}"/></td>
</tr>
<tr>
<td class="tl">横幅图片地址4</td>
<td class="tr"><input name="setting[banner4]" type="text" size="70" id="banner4" value="{$banner4}" readonly ondblclick="if(Dd('banner3').value==''){alert('请先上传横幅图片地址3');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner4').value, true, 'banner4');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="if(Dd('banner3').value==''){alert('请先上传横幅图片地址3');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner4').value, true, 'banner4');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('banner4').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('banner4').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">横幅图片链接4</td>
<td class="tr"><input name="setting[bannerlink4]" type="text" size="70" id="bannerlink4" value="{$bannerlink4}"/></td>
</tr>
<tr>
<td class="tl">横幅图片地址5</td>
<td class="tr"><input name="setting[banner5]" type="text" size="70" id="banner5" value="{$banner5}" readonly ondblclick="if(Dd('banner4').value==''){alert('请先上传横幅图片地址4');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner5').value, true, 'banner5');"/>
<span class="upl">
<img src="{DT_STATIC}image/ico-upl.png" title="上传" onclick="if(Dd('banner4').value==''){alert('请先上传横幅图片地址4');return false;}Dthumb({$moduleid},Dd('bannerw').value,Dd('bannerh').value, Dd('banner5').value, true, 'banner5');"/>
<img src="{DT_STATIC}image/ico-view.png" title="预览" onclick="_preview(Dd('banner5').value);"/>
<img src="{DT_STATIC}image/ico-del.png" title="删除" onclick="Dd('banner5').value='';"/>
</span>
</td>
</tr>
<tr>
<td class="tl">横幅图片链接5</td>
<td class="tr"><input name="setting[bannerlink5]" type="text" size="70" id="bannerlink5" value="{$bannerlink5}"/></td>
</tr>
</tbody>
<tr>
<td class="tl">形象视频地址</td>
<td class="tr">{template 'upload-video', 'chip'}<script type="text/javascript">$(function(){$('#video').attr('name', 'setting[video]');});</script></td>
</tr>
<tr>
<td class="tl">网站公告</td>
<td class="tr f_gray"><textarea name="setting[announce]" id="announce" style="width:433px;height:60px;">{$announce}</textarea><br/>支持HTML语法</td>
</tr>
<tr>
<td class="tl">访问次数</td>
<td class="tr">
<label><input type="radio" name="setting[show_stats]" value="1" id="s_s_1"{if $show_stats==1} checked{/if}/> 显示</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label><input type="radio" name="setting[show_stats]" value="0" id="s_s_0"{if $show_stats==0} checked{/if}/> 不显示</label> 
</td>
</tr>
</table>
</div>

<div id="Tabs1" style="display:none;">
<table cellpadding="10" cellspacing="1" class="tb">
<tr style="display:{if $MG[home_menu]}{else}none{/if};">
<td class="tl">菜单设置<br/><br/><br/><a href="?action=reset&item=menu" class="t" onclick="return confirm('确定要恢复菜单设置为默认吗？');">恢复默认</a></td>
<td class="tr">
<table cellpadding="3" cellspacing="3">
<tr align="center">
<td width="50">显示</td>
<td width="50">排序</td>
<td width="100">名称</td>
<td width="50">分页</td>
</tr>
{loop $U_MENU $k $v}
{if isset($G_MENU[$k])}
<tr align="center">
<td>
<input type="checkbox" value="{$k}"{if $v[status]} checked{/if} onclick="Dd('menu_{$k}').value=this.checked ? 1 : 0;"/><input type="hidden" name="home[menu][{$k}][status]" value="{$v[status]}" id="menu_{$k}"/>
</td>
<td><input type="text" name="home[menu][{$k}][listorder]" size="3" value="{$v[listorder]}"/></td>
<td><input type="text" name="home[menu][{$k}][name]" size="20" value="{$v[name]}"/></td>
<td><input type="text" name="home[menu][{$k}][pagesize]" size="3" value="{$v[pagesize]}"/>
</tr>
{/if}
{/loop}
{loop $G_MENU $k $v}
{if !isset($U_MENU[$k])}
<tr align="center">
<td>
<input type="checkbox" value="{$k}"{if $v[status]} checked{/if} onclick="Dd('menu_{$k}').value=this.checked ? 1 : 0;"/><input type="hidden" name="home[menu][{$k}][status]" value="{$v[status]}" id="menu_{$k}"/>
</td>
<td><input type="text" name="home[menu][{$k}][listorder]" size="3" value="{$v[listorder]}"/></td>
<td><input type="text" name="home[menu][{$k}][name]" size="20" value="{$v[name]}"/></td>
<td><input type="text" name="home[menu][{$k}][pagesize]" size="3" value="{$v[pagesize]}"/>
</tr>
{/if}
{/loop}
</table>
</td>
</tr>
</table>
</div>

<div id="Tabs2" style="display:none;">
<table cellpadding="10" cellspacing="1" class="tb">
<tr>
<td class="tl">侧栏宽度</td>
<td class="tr"><input type="text" size="5" name="setting[side_width]" value="{$side_width}"/> px</td>
</tr>
<tr>
<td class="tl">侧栏位置</td>
<td class="tr">
<table>
<tr align="center">
<td width="100"><img src="{DT_STATIC}member/side_l.gif" title="侧栏在左" onclick="Dd('s_p_0').checked=true;"/></td>
<td width="100"><img src="{DT_STATIC}member/side_r.gif" title="侧栏在右" onclick="Dd('s_p_1').checked=true;"/></td>
</tr>
<tr align="center">
<td><label><input type="radio" name="setting[side_pos]" value="0" id="s_p_0"{if $side_pos==0} checked{/if}/> 侧栏在左</label></td>
<td><label><input type="radio" name="setting[side_pos]" value="1" id="s_p_1"{if $side_pos==1} checked{/if}/> 侧栏在右</label></td>
</tr>
</table>
</td>
</tr>
<tr style="display:{if $MG[home_side]}{else}none{/if};">
<td class="tl">侧栏设置<br/><br/><br/><a href="?action=reset&item=side" class="t" onclick="return confirm('确定要恢复侧栏位置为默认吗？');">恢复默认</a></td>
<td class="tr">
<table cellpadding="3" cellspacing="3">
<tr align="center">
<td width="50">显示</td>
<td width="50">排序</td>
<td width="100">名称</td>
<td width="50">数量</td>
</tr>
{loop $U_SIDE $k $v}
{if isset($G_SIDE[$k])}
<tr align="center">
<td>
<input type="checkbox" value="{$k}"{if $v[status]} checked{/if} onclick="Dd('side_{$k}').value=this.checked ? 1 : 0;"/><input type="hidden" name="home[side][{$k}][status]" value="{$v[status]}" id="side_{$k}"/>
</td>
<td><input type="text" name="home[side][{$k}][listorder]" size="3" value="{$v[listorder]}"/></td>
<td><input type="text" name="home[side][{$k}][name]" size="20" value="{$v[name]}"/></td>
<td><input type="text" name="home[side][{$k}][pagesize]" size="3" value="{$v[pagesize]}"/>
</tr>
{/if}
{/loop}
{loop $G_SIDE $k $v}
{if !isset($U_SIDE[$k])}
<tr align="center">
<td>
<input type="checkbox" value="{$k}"{if $v[status]} checked{/if} onclick="Dd('side_{$k}').value=this.checked ? 1 : 0;"/><input type="hidden" name="home[side][{$k}][status]" value="{$v[status]}" id="side_{$k}"/>
</td>
<td><input type="text" name="home[side][{$k}][listorder]" size="3" value="{$v[listorder]}"/></td>
<td><input type="text" name="home[side][{$k}][name]" size="20" value="{$v[name]}"/></td>
<td><input type="text" name="home[side][{$k}][pagesize]" size="3" value="{$v[pagesize]}"/>
</tr>
{/if}
{/loop}
</table>
</td>
</tr>
</table>
</div>

<div id="Tabs3" style="display:none;">
<table cellpadding="10" cellspacing="1" class="tb"><tr style="display:{if $MG[home_main]}{else}none{/if};">
<td class="tl">首页主栏设置<br/><br/><br/><a href="?action=reset&item=main" class="t" onclick="return confirm('确定要恢复首页主栏为默认吗？');">恢复默认</a></td>
<td class="tr">
<table cellpadding="3" cellspacing="3">
<tr align="center">
<td width="50">显示</td>
<td width="50">排序</td>
<td width="100">名称</td>
<td width="50">数量</td>
</tr>
{loop $U_MAIN $k $v}
{if isset($G_MAIN[$k])}
<tr align="center">
<td>
<input type="checkbox" value="{$k}"{if $v[status]} checked{/if} onclick="Dd('main_{$k}').value=this.checked ? 1 : 0;"/><input type="hidden" name="home[main][{$k}][status]" value="{$v[status]}" id="main_{$k}"/>
</td>
<td><input type="text" name="home[main][{$k}][listorder]" size="3" value="{$v[listorder]}"/></td>
<td><input type="text" name="home[main][{$k}][name]" size="20" value="{$v[name]}"/></td>
<td><input type="text" name="home[main][{$k}][pagesize]" size="3" value="{$v[pagesize]}"/>
</tr>
{/if}
{/loop}
{loop $G_MAIN $k $v}
{if !isset($U_MAIN[$k])}
<tr align="center">
<td>
<input type="checkbox" value="{$k}"{if $v[status]} checked{/if} onclick="Dd('main_{$k}').value=this.checked ? 1 : 0;"/><input type="hidden" name="home[main][{$k}][status]" value="{$v[status]}" id="main_{$k}"/>
</td>
<td><input type="text" name="home[main][{$k}][listorder]" size="3" value="{$v[listorder]}"/></td>
<td><input type="text" name="home[main][{$k}][name]" size="20" value="{$v[name]}"/></td>
<td><input type="text" name="home[main][{$k}][pagesize]" size="3" value="{$v[pagesize]}"/>
</tr>
{/if}
{/loop}
</table>
</td>
</tr>
<tr>
<td class="tl">公司简介显示</td>
<td class="tr"><input type="text" size="5" name="setting[intro_length]" value="{$intro_length}"/> 字符</td>
</tr>
</table>
</div>

<div id="Tabs4" style="display:none;">
<table cellpadding="10" cellspacing="1" class="tb">
<tr>
<td class="tl">首页SEO标题</td>
<td class="tr f_gray"><input type="text" size="80" name="setting[seo_title]" value="{$seo_title}"/>&nbsp; 留空则显示公司名称</td>
</tr>
<tr>
<td class="tl">网站关键词</td>
<td class="tr"><input type="text" size="80" name="setting[seo_keywords]" value="{$seo_keywords}"/></td>
</tr>
<tr>
<td class="tl">网站描述</td>
<td class="tr"><input type="text" size="80" name="setting[seo_description]" value="{$seo_description}"/></td>
</tr>
{if $api_map && $MG[map]}
{php include load('api/map/'.$api_map.'/post.inc');}
{/if}
{if $api_stats && $MG[stats]}
{php include load('api/stats/these.name');}
<tr>
<td class="tl">统计类型</td>
<td class="tr">
<select name="setting[stats_type]" id="stats_type_s" onchange="stats_type(this.value)">
{loop $api_stats $v}
<option value="{$v}">{$names[$v]}</option>
{/loop}
</select>
</td>
</tr>
{loop $api_stats $v}
{php include load('api/stats/'.$v.'/post.inc');}
{/loop}
{/if}

{if $api_kf && $MG[kf]}
{php include load('api/kf/these.name');}
<tr>
<td class="tl">客服类型</td>
<td class="tr">
<select name="setting[kf_type]" id="kf_type_s" onchange="kf_type(this.value)">
{loop $api_kf $v}
<option value="{$v}">{$names[$v]}</option>
{/loop}
</select>
</td>
</tr>
{loop $api_kf $v}
{php include load('api/kf/'.$v.'/post.inc');}
{/loop}
{/if}
</table>
</div>
<table cellpadding="10" cellspacing="1" class="tb">
{if $need_captcha}
<tr>
<td class="tl"><span class="f_red">*</span> 验证码</td>
<td class="tr">{template 'captcha', 'chip'} <span id="dcaptcha" class="f_red"></span></td>
</tr>
{/if}
{if !$CK}
<tr>
<td class="tl">&nbsp;</td>
<td class="tr" height="30">
<input type="submit" name="submit" value=" 保存设置 " class="btn_g"/>&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value=" 清空设置 " class="btn_r" onclick="if(confirm('确定要清空设置吗？商铺所有设置将被清空')){Go('?action=reset');}else{return false;}"/>&nbsp;&nbsp;&nbsp;&nbsp;{if $need_check}<span class="f_gray">需审核</span>{/if}
</td>
</tr>
{/if}
</table>
</form>
{load('clear.js')}
<script type="text/javascript">
s('homepage');
{if $tab}
Tab({$tab});
{else}
m('Tab0');
{/if}
{if $api_stats && $MG[stats]}
function stats_type(type) {
	var stats_types = [{loop $api_stats $k $v}{if $k},{/if}'{$v}'{/loop}];
	var stats_pass = 0;
	for(var i = 0; i < stats_types.length; i++) {
		if(type == stats_types[i]) {
			stats_pass = 1;
			break;
		}
	}
	if(stats_pass == 0) type = stats_types[0];
	for(var i = 0; i < stats_types.length; i++) {
		if(type == stats_types[i]) {
			Ds('stats_post_'+stats_types[i]);
		} else {
			Dh('stats_post_'+stats_types[i]);
		}
	}
	$('#stats_type_s').val(type);
}
stats_type('{$stats_type}');
{/if}
{if $api_kf && $MG[kf]}
function kf_type(type) {
	var kf_types = [{loop $api_kf $k $v}{if $k},{/if}'{$v}'{/loop}];
	var kf_pass = 0;
	for(var i = 0; i < kf_types.length; i++) {
		if(type == kf_types[i]) {
			kf_pass = 1;
			break;
		}
	}
	if(kf_pass == 0) type = kf_types[0];
	for(var i = 0; i < kf_types.length; i++) {
		if(type == kf_types[i]) {
			Ds('kf_post_'+kf_types[i]);
		} else {
			Dh('kf_post_'+kf_types[i]);
		}
		$('#kf_type_s').val(type);
	}
}
kf_type('{$kf_type}');
{/if}
function Dcheck() {
{if $need_captcha}
	f = 'captcha';
	if($('#c'+f).html().indexOf('ok.png') == -1) {
		Dmsg('请填写正确的验证码', f);
		return false;
	}
{/if}
{if $need_check}
	return confirm('当前设置需要审核，确定要提交吗？');
{/if}
	return true;
}
$(function(){
	{if $CK}
	$('input,select,textarea').attr('disabled', 'disabled');
	{/if}
});
</script>
{template 'footer', 'member'}