{template 'header', 'member'}
<div id="head-bar">
<div class="head-bar">
<div class="head-bar-back"><a href="{if $back_link}{$back_link}{else}javascript:Dback();" id="back-{$js_pageid}{/if}" data-direction="reverse"><img src="{DM_SKIN}icon-back{$wh}.png" width="24" height="24"/></a></div>
<div class="head-bar-title">{$head_name}</div>
<div class="head-bar-right"><a href="index.php"><img src="{DM_SKIN}icon-cancel{$wh}.png" width="24" height="24"/></a></div>
</div>
<div class="head-bar-fix" id="load-fix-{$js_pageid}" style="height:0;"></div>
<div class="head-bar-fix" id="head-fix-{$js_pageid}"></div>
</div>
{if $_U}
	<div class="warn">当前资料<span class="f_red">正在审核中</span>，暂时不可修改</div>
{/if}
{load('webuploader.min.js')}
<form method="post" action="?" onsubmit="return Dcheck();" id="dform">
<input type="hidden" name="tab" id="tab" value="{$tab}"/>
<div class="main">
<div class="blank-32"></div>
<div class="list-set" id="Tab0" onclick="$('#Tabs0').slideToggle('fast');$('#tab').val(0);">
<ul>
<li><div><span>{$_username}</span><b>个人资料</b></div></li>
</div>
<div class="ui-form dsn" id="Tabs0">
{if $vtruename}
<p>姓名<i>*</i></p>
<div>{$truename}<span class="f_r"><span class="f_green">已认证</span> &nbsp; <a href="validate.php?action=truename" class="b">修改</a></span></div>
{else}
<p>姓名<i>*</i><b id="dtruename"></b></p>
<div><input type="text" name="post[truename]" id="truename" value="{$truename}"/></div>
{/if}
<p>性别<i>*</i><b id="dgender"></b></p>
<div>
<label><input type="radio" name="post[gender]" value="1" {if $gender==1}checked="checked"{/if}/> 先生</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label><input type="radio" name="post[gender]" value="2" {if $gender==2}checked="checked"{/if}/> 女士</label>
</div>
{if $enterprise}
<p>部门</p>
<div><input type="text" name="post[department]" id="department" value="{$department}"/></div>
<p>职位</p>
<div><input type="text" name="post[career]" id="career" value="{$career}"/></div>
{/if}
{if $vmobile}
<p>手机<i>*</i></p>
<div>{hide_str($mobile)}<span class="f_r"><span class="f_green">已认证</span> &nbsp; <a href="validate.php?action=mobile" class="b">修改</a></span></div>
{else}
<p>手机{if $MOD[mobile_register] == 2}<i>*</i>{/if}<b id="dmobile"></b></p>
<div><input type="tel" name="post[mobile]" id="mobile" value="{$mobile}"/></div>
{/if}
{if $vemail}
<p>邮件<i>*</i></p>
<div>{hide_str($email)}<span class="f_r"><span class="f_green">已认证</span> &nbsp; <a href="validate.php?action=email" class="b">修改</a></span></div>
{else}
<p>邮件{if $MOD[email_register] == 2}<i>*</i>{/if}<b id="demail"></b></p>
<div><input type="email" name="post[email]" id="email" value="{$email}"/></div>
{/if}
{if $DT[im_qq]}
<p>QQ{if $MOD[qq_register] == 2}<i>*</i>{/if}<b id="dqq"></b></p>
<div><input type="tel" name="post[qq]" id="qq" value="{$qq}" style="width:50%;"/></div>
{/if}
{if $DT[im_wx]}
<p>微信{if $MOD[wx_register] == 2}<i>*</i>{/if}<b id="dwx"></b></p>
<div><input type="text" name="post[wx]" id="wx" value="{$wx}" style="width:50%;"/></div>
<p>微信二维码</p>
<div>
<input type="hidden" name="post[wxqr]" id="wxqr" value="{$wxqr}"/>
<div class="ui-form-thumb-show" id="wxqr-show" onclick="wxqr_action();"></div>
<div class="ui-form-thumb-upload" id="wxqr-upload"><div id="wxqr-picker"></div></div>
<script type="text/javascript">
function wxqr_action() {
	Dsheet('{$js_pageid}','<a href="javascript:wxqr_delete();void(0);"><span style="color:red;">删除图片</span></a>', '取消', '确定要删除图片吗？');
}
function wxqr_delete() {
	$('#wxqr').val('');
	$('#wxqr-show').html('');
	$('#wxqr-show').hide();
	$('#wxqr-upload').show();	
}
function wxqr_show(url) {
	$('#wxqr').val(url);
	$('#wxqr-show').html('<img src="'+url+'"/>');
	$('#wxqr-show').show();
	$('#wxqr-upload').hide();	
} 
var wxqru = WebUploader.create({
	auto: true,
    server: UPPath+'?moduleid={$moduleid}&action=webuploader&from=thumb&width=128&height=128',
    pick: '#wxqr-picker',
    accept: {
        title: 'Images',
        extensions: 'jpg,jpeg,png,gif,bmp',
        mimeTypes: 'image/*'
    },
    resize: false
});
wxqru.on('beforeFileQueued', function(file) {
	var exts = wxqru.options.accept[0].extensions;
	if((','+exts).indexOf(','+ext(file.name)) == -1) {
		alert(L['upload_ext']+ext(file.name)+' '+L['upload_allow']+exts);
		return false;
	}
});
wxqru.on('fileQueued', function(file) {
    Dtoast('{$js_pageid}',L['uploading'], '', 30);
});
wxqru.on('uploadProgress', function(file, percentage) {
	var p = parseInt(percentage * 100);
	$('#toast-{$js_pageid}').html(p > 99 ? L['processing'] : L['uploading']+p+'%');
});
wxqru.on( 'uploadSuccess', function(file, data) {
    if(data.error) {
		Dtoast('{$js_pageid}',data.message, '', 5);
	} else {
		wxqr_show(data.url);
	}
});
wxqru.on( 'uploadError', function(file, data) {
    Dtoast('{$js_pageid}',data.message, '', 5);
});
wxqru.on('uploadComplete', function(file) {
    $('#toast-{$js_pageid}').hide();
});
{if $wxqr}
$(function(){
	wxqr_show('{$wxqr}');
});
{/if}
</script>
</div>
{/if}
{if $DT[im_ali]}
<p>旺旺</p>
<div><input type="text" name="post[ali]" id="ali" value="{$ali}" style="width:50%;"/></div>
{/if}
{if $DT[im_skype]}
<p>Skype</p>
<div><input type="text" name="post[skype]" id="skype" value="{$skype}" style="width:50%;"/></div>
{/if}
<p>个性签名<i>*</i><b id="dsign"></b></p>
<div><input type="text" name="post[sign]" id="sign" value="{$sign}" maxlength="200"/></div>
{if in_array('sign', $_E)}<s>{if isset($_U[sign])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>空间封面</p>
<div>
<input type="hidden" name="post[cover]" id="cover" value="{$cover}"/>
<div class="ui-form-thumb-show" id="cover-show" onclick="cover_action();"></div>
<div class="ui-form-thumb-upload" id="cover-upload"><div id="cover-picker"></div></div>
<script type="text/javascript">
function cover_action() {
	Dsheet('{$js_pageid}','<a href="javascript:cover_delete();void(0);"><span style="color:red;">删除图片</span></a>', '取消', '确定要删除图片吗？');
}
function cover_delete() {
	$('#cover').val('');
	$('#cover-show').html('');
	$('#cover-show').hide();
	$('#cover-upload').show();	
}
function cover_show(url) {
	$('#cover').val(url);
	$('#cover-show').html('<img src="'+url+'"/>');
	$('#cover-show').show();
	$('#cover-upload').hide();	
} 
var coveru = WebUploader.create({
	auto: true,
    server: UPPath+'?moduleid={$moduleid}&action=webuploader&from=thumb&width=1220&height=200',
    pick: '#cover-picker',
    accept: {
        title: 'Images',
        extensions: 'jpg,jpeg,png,gif,bmp',
        mimeTypes: 'image/*'
    },
    resize: false
});
coveru.on('beforeFileQueued', function(file) {
	var exts = coveru.options.accept[0].extensions;
	if((','+exts).indexOf(','+ext(file.name)) == -1) {
		alert(L['upload_ext']+ext(file.name)+' '+L['upload_allow']+exts);
		return false;
	}
});
coveru.on('fileQueued', function(file) {
    Dtoast('{$js_pageid}',L['uploading'], '', 30);
});
coveru.on('uploadProgress', function(file, percentage) {
	var p = parseInt(percentage * 100);
	$('#toast-{$js_pageid}').html(p > 99 ? L['processing'] : L['uploading']+p+'%');
});
coveru.on( 'uploadSuccess', function(file, data) {
    if(data.error) {
		Dtoast('{$js_pageid}',data.message, '', 5);
	} else {
		cover_show(data.url);
	}
});
coveru.on( 'uploadError', function(file, data) {
    Dtoast('{$js_pageid}',data.message, '', 5);
});
coveru.on('uploadComplete', function(file) {
    $('#toast-{$js_pageid}').hide();
});
{if $cover}
$(function(){
	cover_show('{$cover}');
});
{/if}
</script>
</div>
{if in_array('cover', $_E)}<s>{if isset($_U[cover])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
{if !$enterprise}
<p>地区<i>*</i><b id="dareaid"></b></p>
<div>{ajax_area_select('post[areaid]', '请选择', $areaid)}</div>
{if in_array('areaid', $_E)}<s>{if isset($_U[areaid])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>地址</p>
<div><input type="text" name="post[address]" id="daddress" value="{$address}"/></div>
{if $DT[postcode]}
<p>邮编</p>
<div><input type="tel" name="post[postcode]" id="postcode" value="{$postcode}" style="width:50%;"/></div>
{/if}
<p>电话</p>
<div><input type="tel" name="post[telephone]" id="telephone" value="{$telephone}"/></div>
{/if}
<div class="blank-32"></div>
</div>
<div class="blank-32"></div>

<div class="list-set" id="Tab1" onclick="$('#Tabs1').slideToggle('fast');$('#tab').val(1);">
<ul>
<li><div><span>修改密码</span><b>密码管理</b></div></li>
</div>
<div class="ui-form dsn" id="Tabs1">
<p>新登录密码<b id="dpassword"></b></p>
<div><input type="password" name="post[password]" id="password" autocomplete="new-password"/></div>
<p>重复登录密码<b id="dcpassword"></b></p>
<div><input type="password" name="post[cpassword]" id="cpassword" autocomplete="new-password"/></div>
<p>现有密码<b id="doldpassword"></b></p>
<div class="blank-16"></div>
<a href="logout.php?forward=send.php" class="b">找回登录密码</a>
<div class="blank-16"></div>
<div><input type="password" name="post[oldpassword]" id="oldpassword" autocomplete="new-password"/></div>
<p>新支付密码<b id="dpayword"></b></p>
<div><input type="password" name="post[payword]" id="payword" autocomplete="new-password"/></div>
<p>重复支付密码<b id="dcpassword"></b></p>
<div><input type="password" name="post[cpayword]" id="cpayword" autocomplete="new-password"/></div>
<p>现有支付密码<b id="doldpayword"></b></p>
<div><input type="password" name="post[oldpayword]" id="oldpayword" autocomplete="new-password"/></div>
<div class="blank-16"></div>
<a href="send.php" class="b">找回支付密码</a>
<div class="blank-16"></div>
</div>
<div class="blank-32"></div>

{if $enterprise}
<div class="list-set" id="Tab2" onclick="$('#Tabs2').slideToggle('fast');$('#tab').val(2);">
<ul>
<li><div><span>{$_company}</span><b>公司资料</b></div></li>
</div>
<div class="ui-form dsn" id="Tabs2">
<p>公司全称<i>*</i></p>
<div>{$company}<span class="f_r">{if $vcompany}<span class="f_green">已认证</span> &nbsp; {/if}<a href="validate.php?action=company" class="b">修改</a></span></div>
<p>公司类型<i>*</i><b id="dtype"></b></p>
<div>{dselect($COM_TYPE, 'post[type]', '请选择', $type, 'id="type"', 0)}</div>
{if in_array('type', $_E)}<s>{if isset($_U[type])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>所在地区<i>*</i><b id="dareaid"></b></p>
<div>{ajax_area_select('post[areaid]', '请选择', $areaid)}</div>
{if in_array('areaid', $_E)}<s>{if isset($_U[areaid])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>主营行业<i>*</i><b id="dcatid"></b></p>
<div><span id="cate">{ajax_category_select('', '请选择行业', 0, 4)}</span> &nbsp; <a href="javascript:cate_add({$MOD[cate_max]});void(0);" class="b">添加</a></div>
<style type="text/css">
#cate-box background:#EEEEEE;padding:6px 12px;}
#cate-box div {height:24px;line-height:24px;overflow:hidden;}
#cate-box span {float:right;}
</style>
<div id="cate-box">
<div id="cate-tip"{if $cates}style="display:none;"{/if}>请添加主营行业，最多可添加 <strong class="f_red">{$MOD[cate_max]}</strong> 个</div>
{loop $cates $c}
<div id="cate-{$c}"><span><a href="javascript:cate_del({$c});void(0);" class="b">删除</a></span>{strip_tags(cat_pos(get_cat($c), '/'))}</div>
{/loop}
</div>
<input type="hidden" name="post[catid]" value="{$catid}" id="catid"/>
<p>主营范围<i>*</i><b id="dbusiness"></b></p>
<div><input type="text" name="post[business]" id="business" value="{$business}" maxlength="200"/></div>
{if in_array('business', $_E)}<s>{if isset($_U[business])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>成立年份<i>*</i><b id="dregyear"></b></p>
<div><input type="tel" name="post[regyear]" id="regyear" value="{$regyear}" style="width:100px;"/></div>
{if in_array('regyear', $_E)}<s>{if isset($_U[regyear])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>形象图片</p>
<div>
<input type="hidden" name="post[thumb]" id="thumb" value="{$thumb}"/>
<div class="ui-form-thumb-show" id="thumb-show" onclick="thumb_action();"></div>
<div class="ui-form-thumb-upload" id="thumb-upload"><div id="thumb-picker"></div></div>
<script type="text/javascript">
function thumb_action() {
	Dsheet('{$js_pageid}','<a href="javascript:thumb_delete();"><span style="color:red;">删除图片</span></a>', '取消', '确定要删除图片吗？');
}
function thumb_delete() {
	$('#thumb').val('');
	$('#thumb-show').html('');
	$('#thumb-show').hide();
	$('#thumb-upload').show();	
}
function thumb_show(url) {
	$('#thumb').val(url);
	$('#thumb-show').html('<img src="'+url+'"/>');
	$('#thumb-show').show();
	$('#thumb-upload').hide();	
} 
var thumbu = WebUploader.create({
	auto: true,
    server: UPPath+'?moduleid={$moduleid}&action=webuploader&from=thumb&width={$MOD[thumb_width]}&height={$MOD[thumb_height]}',
    pick: '#thumb-picker',
    accept: {
        title: 'Images',
        extensions: 'jpg,jpeg,png,gif,bmp',
        mimeTypes: 'image/*'
    },
    resize: false
});
thumbu.on('beforeFileQueued', function(file) {
	var exts = thumbu.options.accept[0].extensions;
	if((','+exts).indexOf(','+ext(file.name)) == -1) {
		alert(L['upload_ext']+ext(file.name)+' '+L['upload_allow']+exts);
		return false;
	}
});
thumbu.on('fileQueued', function(file) {
    Dtoast('{$js_pageid}',L['uploading'], '', 30);
});
thumbu.on('uploadProgress', function(file, percentage) {
	var p = parseInt(percentage * 100);
	$('#toast-{$js_pageid}').html(p > 99 ? L['processing'] : L['uploading']+p+'%');
});
thumbu.on('uploadSuccess', function(file, data) {
    if(data.error) {
		Dtoast('{$js_pageid}',data.message, '', 5);
	} else {
		thumb_show(data.url);
	}
});
thumbu.on('uploadError', function(file, data) {
    Dtoast('{$js_pageid}',data.message, '', 5);
});
thumbu.on('uploadComplete', function(file) {
    $('#toast-{$js_pageid}').hide();
});
{if $thumb}
$(function(){
	thumb_show('{$thumb}');
});
{/if}
</script>
</div>
{if in_array('thumb', $_E)}<s>{if isset($_U[thumb])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
{if $mode_check}
<p>经营模式</p>
<div id="com_mode">{$mode_check}</div>
{/if}
{if $invoice_check}
<p>可开发票</p>
<div>{$invoice_check}</div>
{/if}
{if $MG[agent]}
<p>分销代理</p>
<div>
<label><input type="radio" name="post[agent]" value="1" {if $agent==1}checked="checked"{/if}/> 开启</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label><input type="radio" name="post[agent]" value="0" {if $agent==0}checked="checked"{/if}/> 关闭</label>
</div>
{/if}
{if $MG[trade_order] || $MG[group_order]}
<p>确认订单</p>
<div>
<label><input type="radio" name="post[checkorder]" value="1" {if $checkorder==1}checked="checked"{/if}/> 开启</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label><input type="radio" name="post[checkorder]" value="0" {if $checkorder==0}checked="checked"{/if}/> 关闭</label>
</div>
<s>订单需要您确认后买家才能付款</s>
{/if}
{if $MG[bill]}
<p>线下收款</p>
<div>
<label><input type="radio" name="post[bill]" value="1" {if $bill==1}checked="checked"{/if}/> 开启</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label><input type="radio" name="post[bill]" value="0" {if $bill==0}checked="checked"{/if}/> 关闭</label>
</div>
<s>允许买家直接向<a href="validate.php?action=bank" class="b">已认证银行账号</a>转账</s>
{/if}
<p>公司规模</p>
<div>{dselect($COM_SIZE, 'post[size]', '请选择规模', $size, '', 0)}</div>
<p>注册资本</p>
<div>{dselect($MONEY_UNIT, 'post[regunit]', '', $regunit, '', 0)} <input type="tel" name="post[capital]" id="capital" value="{$capital}" style="width:100px;"/> 万</div>
{if in_array('regunit', $_E)}<s>{if isset($_U[regunit])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>销售产品</p>
<div><input type="text" name="post[sell]" id="sell" value="{$sell}"/></div>
<p>采购产品</p>
<div><input type="text" name="post[buy]" id="buy" value="{$buy}"/></div>
<div class="blank-32"></div>
</div>
<div class="blank-32"></div>

<div class="list-set" id="Tab3" onclick="$('#Tabs3').slideToggle('fast');$('#tab').val(3);">
<ul>
<li><div><b>联系方式</b></div></li>
</div>
<div class="ui-form dsn" id="Tabs3">
<p>公司地址<i>*</i><b id="ddaddress"></b></p>
<div><input type="text" name="post[address]" id="daddress" value="{$address}"/></div>
{if in_array('address', $_E)}<s>{if isset($_U[address])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
{if $DT[postcode]}
<p>邮政编码</p>
<div><input type="tel" name="post[postcode]" id="postcode" value="{$postcode}" style="width:50%;"/></div>
{/if}
<p>公司电话<i>*</i><b id="dtelephone"></b></p>
<div><input type="tel" name="post[telephone]" id="telephone" value="{$telephone}"/></div>
{if in_array('telephone', $_E)}<s>{if isset($_U[telephone])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>公司传真</p>
<div><input type="tel" name="post[fax]" id="fax" value="{$fax}"/></div>
<p>公司邮件</p>
<div><input type="email" name="post[mail]" id="mail" value="{$mail}"/></div>
<p>公司网址</p>
<div><input type="url" name="post[homepage]" id="homepage" value="{$homepage}"/></div>
{if in_array('homepage', $_E)}<s>{if isset($_U[homepage])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>微信公众号</p>
<div><input type="text" name="post[gzh]" id="gzh" value="{$gzh}" style="width:50%;"/></div>
{if in_array('gzh', $_E)}<s>{if isset($_U[gzh])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<p>公众号二维码</p>
<div>
<input type="hidden" name="post[gzhqr]" id="gzhqr" value="{$gzhqr}"/>
<div class="ui-form-thumb-show" id="gzhqr-show" onclick="gzhqr_action();"></div>
<div class="ui-form-thumb-upload" id="gzhqr-upload"><div id="gzhqr-picker"></div></div>
<script type="text/javascript">
function gzhqr_action() {
	Dsheet('{$js_pageid}','<a href="javascript:gzhqr_delete();"><span style="color:red;">删除图片</span></a>', '取消', '确定要删除图片吗？');
}
function gzhqr_delete() {
	$('#gzhqr').val('');
	$('#gzhqr-show').html('');
	$('#gzhqr-show').hide();
	$('#gzhqr-upload').show();	
}
function gzhqr_show(url) {
	$('#gzhqr').val(url);
	$('#gzhqr-show').html('<img src="'+url+'"/>');
	$('#gzhqr-show').show();
	$('#gzhqr-upload').hide();	
} 
var gzhqru = WebUploader.create({
	auto: true,
    server: UPPath+'?moduleid={$moduleid}&action=webuploader&from=thumb&width=128&height=128',
    pick: '#gzhqr-picker',
    accept: {
        title: 'Images',
        extensions: 'jpg,jpeg,png,gif,bmp',
        mimeTypes: 'image/*'
    },
    resize: false
});
gzhqru.on('beforeFileQueued', function(file) {
	var exts = gzhqru.options.accept[0].extensions;
	if((','+exts).indexOf(','+ext(file.name)) == -1) {
		alert(L['upload_ext']+ext(file.name)+' '+L['upload_allow']+exts);
		return false;
	}
});
gzhqru.on('fileQueued', function(file) {
    Dtoast('{$js_pageid}',L['uploading'], '', 30);
});
gzhqru.on('uploadProgress', function(file, percentage) {
	var p = parseInt(percentage * 100);
	$('#toast-{$js_pageid}').html(p > 99 ? L['processing'] : L['uploading']+p+'%');
});
gzhqru.on( 'uploadSuccess', function(file, data) {
    if(data.error) {
		Dtoast('{$js_pageid}',data.message, '', 5);
	} else {
		gzhqr_show(data.url);
	}
});
gzhqru.on( 'uploadError', function(file, data) {
    Dtoast('{$js_pageid}',data.message, '', 5);
});
gzhqru.on('uploadComplete', function(file) {
    $('#toast-{$js_pageid}').hide();
});
{if $gzhqr}
$(function(){
	gzhqr_show('{$gzhqr}');
});
{/if}
</script>
</div>
{if in_array('gzhqr', $_E)}<s>{if isset($_U[gzhqr])}<span class="f_red">审核中</span>{else}需审核{/if}</s>{/if}
<div class="blank-32"></div>
</div>
<div class="blank-32"></div>
{/if}


{if $enterprise}
<div class="list-set" id="Tab4" onclick="$('#Tabs4').slideToggle('fast');$('#tab').val(4);">
{else}
<div class="list-set" id="Tab2" onclick="$('#Tabs2').slideToggle('fast');$('#tab').val(2);">
{/if}
<ul>
<li><div><b>{if $enterprise}公司{else}个人{/if}介绍</b></div></li>
</div>
<div class="dsn" id="Tabs{if $enterprise}4{else}2{/if}">
<input type="hidden" name="post[content]" id="content"/>
<ul class="ui-editor-toolbar" style="border-top:none;">
<li class="ui-editor-img"><div id="editor-picker"></div></li>
<li class="ui-editor-bold"><input type="button" value=" " editor-action="bold"/>B</li>
<li class="ui-editor-italic"><input type="button" value=" " editor-action="italic"/>I</li>
<li class="ui-editor-underline"><input type="button" value=" " editor-action="underline"/>U</li>
</ul>
<div class="ui-editor-content" id="editor">{$content}</div>
{load('editor.js')}
<script type="text/javascript">
$(function(){
    $('#editor').DEditor({
        editorid: 'editor',
        textareaid: 'content',
        server: UPPath+'?moduleid={$moduleid}&action=webuploader&from=editor'
    });
});
</script>
{if in_array('content', $_E)} &nbsp; &nbsp; {if isset($_U[content])}<span class="f_red px12">审核中</span>{else}<span class="f_gray px12">需审核</span>{/if}{/if}
</div>
{if $need_captcha}
<div class="ui-form">
<p>验证码<i>*</i><b id="dcaptcha"></b></p>
<div>{template 'captcha', 'chip'}</div>
</div>
{/if}
<div class="blank-32"></div>
</div>

{if !$_U}
<div class="blank-32"></div>
<div class="foot-bar-fix"></div>
<div class="foot-btn">
<ul>
<li></li>
<li><input type="submit" name="submit" value="保存修改" class="btn-green"/></li>
<li></li>
</ul>
</div>
{/if}
</form>
<script type="text/javascript">
function Tab(id) {
	$('#Tabs'+id).slideDown('fast');
}
$(function(){
	Tab({$tab});
	{if isset($success)}
	Dtoast('{$js_pageid}','资料保存成功');
	{/if}
});
</script>
{load('clear.js')}
<script type="text/javascript">
function check_mode(c, m) {
	if($('#com_mode input:checkbox:checked').length > m) {confirm('最多可选'+m+'种经营模式'); c.checked = false;}
}
function cate_del(id) {
	$('#cate-'+id).remove();
	var cids = $('#catid').val().replace(','+id+',', ',');
	$('#catid').val(cids);
	if($('#cate-box').html().indexOf('span') == -1) {
		$('#cate-tip').show();
	} else {
		$('#cate-tip').hide();
	}
}
function cate_add(max) {
	if($('#cate-box div').length > max) {
		Dmsg('最多可以添加'+max+'个行业', 'catid');
		return;
	}
	var cid = $('#catid_1').val();
	if(cid == 0) {
		Dmsg('请选择行业', 'catid');
		return;
	}
	if($('#cate-box').html().indexOf('cate-'+cid) != -1) {
		Dmsg('所选行业已经存在', 'catid');
		return;
	}
	var str = '';
	$('#cate option:selected').each(function() {
		if($(this).val()) str += $(this).text()+'/';
	});
	if(str) {
		str = str.replace('&amp;', '&');
		str = str.replace('请选择行业/', '');
		str = str.substring(0, str.length-1);
		$('#cate-box').append('<div id="cate-'+cid+'"><span><a href="javascript:cate_del('+cid+');void(0);" class="b">删除</a></span>'+str+'</div>');
		var cids = $('#catid').val() ? $('#catid').val() +cid+',' : ','+cid+',';
		$('#catid').val(cids);
		$('#cate-tip').hide();
	} else {
		Dmsg('请选择行业', 'catid');
	}
}
var vid = '';
function validator(id) {
	if(!Dd(id).value) return false;
	vid = id;
	$.post(AJPath, 'moduleid={$moduleid}&action=member&job='+id+'&value='+Dd(id).value+'&userid={$userid}', function(data) {
		Dd('d'+vid).innerHTML = data ? data : '';
	});
}
function Dcheck() {
	if(Dd('truename').value == '') {
		Tab(0);
		Dmsg('请填写真实姓名', 'truename');
		return false;
	}
	{if $MOD[mobile_register] == 2 && !$vmobile}
	if(Dd('mobile').value.length != 11) {
		Tab(0);
		Dmsg('请填写手机号码', 'mobile');
		return false;
	}
	{/if}
	{if $MOD[email_register] == 2 && !$vemail}
	if(Dd('email').value.length < 6) {
		Tab(0);
		Dmsg('请填写电子邮箱', 'email');
		return false;
	}
	{/if}
	{if $MOD[qq_register] == 2 && $DT[im_qq]}
	if(Dd('qq').value.length < 5) {
		Tab(0);
		Dmsg('请填写QQ号码', 'qq');
		return false;
	}
	{/if}
	{if $MOD[wx_register] == 2 && $DT[im_wx]}
	if(Dd('wx').value.length < 3) {
		Tab(0);
		Dmsg('请填写微信号码', 'wx');
		return false;
	}
	{/if}
	{if !$enterprise}	
	if(Dd('areaid_1').value == 0) {
		Tab(0);
		Dmsg('请选择地区', 'areaid');
		return false;
	}
	{/if}

	if(Dd('password').value.length > 0  && Dd('password').value.length < 32) {
		if(Dd('cpassword').value.length < 6) {
			Tab(1);
			Dmsg('请重复输入密码', 'cpassword');
			return false;
		}
		if(Dd('password').value != Dd('cpassword').value) {
			Tab(1);
			Dmsg('两次输入的密码不一致', 'password');
			return false;
		}
		if(Dd('oldpassword').value.length < 6) {
			Tab(1);
			Dmsg('请输入密码', 'oldpassword');
			return false;
		}
	}
	if(Dd('payword').value.length > 0 && Dd('payword').value.length < 32) {
		if(Dd('cpayword').value.length < 6) {
			Tab(1);
			Dmsg('请重复输入支付密码', 'cpayword');
			return false;
		}
		if(Dd('payword').value != Dd('cpayword').value) {
			Tab(1);
			Dmsg('两次输入的支付密码不一致', 'payword');
			return false;
		}
		if(Dd('oldpayword').value.length < 6) {
			Tab(1);
			Dmsg('请输入支付密码', 'oldpayword');
			return false;
		}
	}

	var f = 'password';
	var l = Dd(f).value.length;
	if(l > 5 && l < 32) {
		var a = Dpwd(Dd(f).value, '{$MOD[minpassword]}', '{$MOD[maxpassword]}', '{$MOD[mixpassword]}');
		var s = '';
		if(a[0] == 'mix') {
			if(a[1] == '09') s = '密码必须包含数字';
			if(a[1] == 'az') s = '密码必须包含小写字母';
			if(a[1] == 'AZ') s = '密码必须包含大写字母';
			if(a[1] == '..') s = '密码必须包含特殊符号';
		} else if(a[0] == 'min') {
			s = '密码最少'+a[1]+'字符';
		} else if(a[0] == 'max') {
			s = '密码最多'+a[1]+'字符';
		}
		if(s) {
			Tab(1);
			Dmsg(s, f);
			return false;
		}
		{if $DT[md5_pass]==3}
		Dd(f).value = hex_md5(Dd(f).value);
		Dd('c'+f).value = hex_md5(Dd('c'+f).value);			
		Dd('old'+f).value = hex_md5(Dd('old'+f).value);			
		{/if}
	}
	f = 'payword';
	l = Dd(f).value.length;
	if(l > 5 && l < 32) {
		var a = Dpwd(Dd(f).value, '{$MOD[minpassword]}', '{$MOD[maxpassword]}', '{$MOD[mixpassword]}');
		var s = '';
		if(a[0] == 'mix') {
			if(a[1] == '09') s = '密码必须包含数字';
			if(a[1] == 'az') s = '密码必须包含小写字母';
			if(a[1] == 'AZ') s = '密码必须包含大写字母';
			if(a[1] == '..') s = '密码必须包含特殊符号';
		} else if(a[0] == 'min') {
			s = '密码最少'+a[1]+'字符';
		} else if(a[0] == 'max') {
			s = '密码最多'+a[1]+'字符';
		}
		if(s) {
			Tab(1);
			Dmsg(s, f);
			return false;
		}
		{if $DT[md5_pass]==3}
		Dd(f).value = hex_md5(Dd(f).value);
		Dd('c'+f).value = hex_md5(Dd('c'+f).value);
		Dd('old'+f).value = hex_md5(Dd('old'+f).value);
		{/if}
	}

	{if $MFD}{fields_js($MFD)}{/if}
	{if $enterprise}
	{if $CFD}{fields_js($CFD)}{/if}
	if(Dd('type').value == '') {
		Tab(2);
		Dmsg('请选择公司类型', 'type');
		return false;
	}
	if(Dd('areaid_1').value == 0) {
		Tab(2);
		Dmsg('请选择公司所在地', 'areaid');
		return false;
	}
	if(Dd('catid').value.length < 2) {
		Tab(2);
		Dmsg('请选择公司主营行业', 'catid');
		return false;
	}
	if(Dd('business').value.length < 4) {
		Tab(2);
		Dmsg('主要经营范围最少3字', 'business');
		return false;
	}
	if(Dd('regyear').value.length < 4) {
		Tab(2);
		Dmsg('请填写公司成立年份', 'regyear');
		return false;
	}
	if(Dd('daddress').value.length < 5) {
		Tab(3);
		Dmsg('请填写公司地址', 'daddress');
		return false;
	}
	if(Dd('telephone').value.length < 6) {
		Tab(3);
		Dmsg('请填写公司电话', 'telephone');
		return false;
	}
	{/if}	
	{if $need_captcha}
	f = 'captcha';
	if($('#c'+f).html().indexOf('ok.png') == -1) {
		Dmsg('请填写正确的验证码', f);
		return false;
	}
	{/if}
	return true;
}
$(function(){
	{if $_U}
	$('input,select,textarea').attr('disabled', 'disabled');
	{/if}
});
</script>
{if $DT[md5_pass]}{load('md5.js')}<script type="text/javascript">$(function(){cls_pwd();});</script>{/if}
{template 'footer',$module}